# Knowledge Base Transformation

ä¸€ä¸ªç”¨äºå°†Markdownæ–‡æ¡£è½¬æ¢ä¸ºJSONæ ¼å¼å¹¶è¿›è¡Œè¯­ä¹‰å‘é‡åŒ–æœç´¢çš„å·¥å…·åŒ…ã€‚

## ğŸ“„ é¡¹ç›®ç®€ä»‹

è¯¥é¡¹ç›®æä¾›äº†ä¸€å¥—å®Œæ•´çš„çŸ¥è¯†åº“è½¬æ¢è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥ï¼š
- å°†Markdownæ–‡æ¡£è½¬æ¢ä¸ºç»“æ„åŒ–JSONæ ¼å¼
- å¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œæ™ºèƒ½åˆ†å—å’Œè¯­ä¹‰åµŒå…¥
- æä¾›é«˜æ•ˆçš„è¯­ä¹‰æœç´¢åŠŸèƒ½
- æ”¯æŒä¸­æ–‡æ–‡æ¡£å¤„ç†

## âœ¨ ä¸»è¦åŠŸèƒ½

- **Markdownåˆ°JSONè½¬æ¢**ï¼šä¿æŒæ–‡æ¡£ç»“æ„çš„å®Œæ•´æ€§
- **è¯­ä¹‰å‘é‡åŒ–**ï¼šä½¿ç”¨`sentence-transformers`ç”Ÿæˆé«˜è´¨é‡ä¸­æ–‡embedding
- **æ™ºèƒ½åˆ†å—**ï¼šå¯é…ç½®çš„æ–‡æ¡£åˆ†å—ç­–ç•¥
- **è¯­ä¹‰æœç´¢**ï¼šåŸºäºå‘é‡ç›¸ä¼¼åº¦çš„å†…å®¹æ£€ç´¢
- **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒç›®å½•çº§åˆ«çš„æ‰¹é‡è½¬æ¢

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Python 3.13+**
- **æ ¸å¿ƒä¾èµ–**ï¼š
  - `sentence-transformers` - è¯­ä¹‰åµŒå…¥
  - `scikit-learn` - å‘é‡è®¡ç®—
  - `jieba` - ä¸­æ–‡åˆ†è¯
  - `pandas` - æ•°æ®å¤„ç†
  - `numpy` - æ•°å€¼è®¡ç®—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨ uv (æ¨è)
uv sync

# æˆ–ä½¿ç”¨ pip
pip install -r requirements.txt
```

### åŸºæœ¬ä½¿ç”¨

1. **è½¬æ¢Markdownåˆ°JSON**ï¼š
```bash
python main.py
```

1.1 **å«å‚è½¬åŒ–ï¼ˆå‚æ•°å¯ä¿®æ”¹ï¼‰**
```bash
python main.py --input markdown --output output --chunk-size 800 --overlap-size 150
```

2. **å¢å¼ºå‘é‡åŒ–å¤„ç†**ï¼š
```bash
python enhanced_main.py
```

2.1 **ä½¿ç”¨ä¸åŒmodelå®ç°**
```bash
# Sentence-BERT
uv run enhanced_main.py --action vectorize --model-type sentence_transformers
# TF-IDF
uv run enhanced_main.py --action vectorize --model-type tfidf
```
3. **è¯­ä¹‰æœç´¢æµ‹è¯•**
```bash
python semantic_search.py --query "PWMæ§åˆ¶å™¨" --top-k 10
```

æˆ–è€…ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ï¼š
```bash
è¿è¡Œè½¬æ¢.bat
è¿è¡Œå¢å¼ºå‘é‡åŒ–.bat
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ main.py                    # ä¸»è½¬æ¢è„šæœ¬
â”œâ”€â”€ enhanced_main.py           # å¢å¼ºå‘é‡åŒ–è„šæœ¬
â”œâ”€â”€ md_to_json_converter.py    # Markdownè½¬JSONæ ¸å¿ƒæ¨¡å—
â”œâ”€â”€ enhanced_vectorizer.py     # è¯­ä¹‰å‘é‡åŒ–æ¨¡å—
â”œâ”€â”€ semantic_search.py         # è¯­ä¹‰æœç´¢åŠŸèƒ½
â”œâ”€â”€ json_analyzer.py           # JSONåˆ†æå·¥å…·
â”œâ”€â”€ markdown/                  # è¾“å…¥çš„Markdownæ–‡æ¡£
â”œâ”€â”€ output/                    # å¤„ç†ç»“æœè¾“å‡º
â”‚   â”œâ”€â”€ json/                 # JSONè½¬æ¢ç»“æœ
â”‚   â”œâ”€â”€ analysis/             # åˆ†ææŠ¥å‘Š
â”‚   â””â”€â”€ enhanced_embeddings/  # å‘é‡åµŒå…¥æ–‡ä»¶
â””â”€â”€ model_cache/              # é¢„è®­ç»ƒæ¨¡å‹ç¼“å­˜
```

## âš™ï¸ é…ç½®é€‰é¡¹

ä¸»è¦é…ç½®å‚æ•°ï¼š
- `chunk_size`: æ–‡æ¡£åˆ†å—å¤§å° (é»˜è®¤: 500)
- `overlap_size`: åˆ†å—é‡å å¤§å° (é»˜è®¤: 100)  
- `model_name`: ä½¿ç”¨çš„é¢„è®­ç»ƒæ¨¡å‹ (é»˜è®¤: paraphrase-multilingual-MiniLM-L12-v2)

## ğŸ“Š è¾“å‡ºè¯¦ç»†è¯´æ˜

å¤„ç†å®Œæˆåï¼Œ`output/` ç›®å½•ä¼šåŒ…å«ä»¥ä¸‹ç»“æ„åŒ–çš„å¤„ç†ç»“æœï¼š

### ğŸ“‹ ä¸»è¦è¾“å‡ºæ–‡ä»¶

#### `pipeline_stats.json`
åŒ…å«å®Œæ•´çš„å¤„ç†æµç¨‹ç»Ÿè®¡ä¿¡æ¯ï¼š
- å¤„ç†æ—¶é—´æˆ³å’Œé…ç½®å‚æ•°
- å„é˜¶æ®µçš„å¤„ç†ç»Ÿè®¡ï¼ˆè½¬æ¢ã€åˆ†æã€å‘é‡åŒ–ï¼‰
- æ–‡æ¡£ç±»åˆ«å’Œç±»å‹åˆ†å¸ƒç»Ÿè®¡
- æˆåŠŸ/å¤±è´¥è½¬æ¢æ•°é‡

### ğŸ“ json/ - JSONè½¬æ¢ç»“æœ
```
json/
â”œâ”€â”€ all_documents.json          # æ‰€æœ‰æ–‡æ¡£çš„åˆå¹¶JSON
â”œâ”€â”€ index.json                  # æ–‡æ¡£ç´¢å¼•å’Œå…ƒæ•°æ®
â”œâ”€â”€ 32F_documents.json          # 32Fç³»åˆ—èŠ¯ç‰‡æ–‡æ¡£
â”œâ”€â”€ 32M15_documents.json        # 32M15ç³»åˆ—èŠ¯ç‰‡æ–‡æ¡£
â”œâ”€â”€ 92F_documents.json          # 92Fç³»åˆ—èŠ¯ç‰‡æ–‡æ¡£
â”œâ”€â”€ 92L_documents.json          # 92Lç³»åˆ—èŠ¯ç‰‡æ–‡æ¡£
â”œâ”€â”€ 95F_documents.json          # 95Fç³»åˆ—èŠ¯ç‰‡æ–‡æ¡£
â”œâ”€â”€ IC_documents.json           # ICç³»åˆ—èŠ¯ç‰‡æ–‡æ¡£
â””â”€â”€ Industry Application_documents.json  # å·¥ä¸šåº”ç”¨æ–‡æ¡£
```

æ¯ä¸ªJSONæ–‡ä»¶åŒ…å«ï¼š
- æ–‡æ¡£çš„å®Œæ•´ç»“æ„åŒ–å†…å®¹
- ç« èŠ‚å±‚æ¬¡å’Œæ ‡é¢˜ä¿¡æ¯
- è¡¨æ ¼æ•°æ®æå–ç»“æœ
- æ–‡æ¡£å…ƒæ•°æ®ï¼ˆè·¯å¾„ã€ç±»å‹ã€ç±»åˆ«ç­‰ï¼‰

### ğŸ“Š analysis/ - åˆ†ææŠ¥å‘Šå’Œç»Ÿè®¡
```
analysis/
â”œâ”€â”€ analysis_report.md          # è¯¦ç»†åˆ†ææŠ¥å‘Š
â”œâ”€â”€ analysis_result.json        # è¯¦ç»†çš„åˆ†æç»“æœæ•°æ®
â”œâ”€â”€ documents_summary.csv       # æ–‡æ¡£çº§åˆ«ç»Ÿè®¡æ±‡æ€»
â”œâ”€â”€ sections_summary.csv        # ç« èŠ‚çº§åˆ«ç»Ÿè®¡æ±‡æ€»
â”œâ”€â”€ documents_chunks.json       # æ–‡æ¡£åˆ†å—ç»“æœ
â”œâ”€â”€ sections_chunks.json        # ç« èŠ‚åˆ†å—ç»“æœ
â”œâ”€â”€ tables_chunks.json          # è¡¨æ ¼åˆ†å—ç»“æœ
â”œâ”€â”€ vectorization_ready.json    # å‡†å¤‡å‘é‡åŒ–çš„æ•°æ®
â”œâ”€â”€ advanced_index.json         # é«˜çº§ç´¢å¼•ä¿¡æ¯
â””â”€â”€ search_config.json          # æœç´¢é…ç½®æ–‡ä»¶
```

**åˆ†ææŠ¥å‘Šå†…å®¹**ï¼š
- æ–‡æ¡£æ•°é‡å’Œåˆ†å¸ƒç»Ÿè®¡
- èŠ¯ç‰‡ç±»åˆ«å æ¯”åˆ†æ
- æ–‡æ¡£ç±»å‹åˆ†å¸ƒï¼ˆæ‰‹å†Œã€æ•°æ®è¡¨ã€æ•…éšœæ’é™¤ç­‰ï¼‰
- å†…å®¹é•¿åº¦å’Œå¤æ‚åº¦åˆ†æ

### ğŸ” enhanced_embeddings/ - å‘é‡åµŒå…¥æ–‡ä»¶
```
enhanced_embeddings/
â”œâ”€â”€ embedding_config.json       # å‘é‡åŒ–é…ç½®ä¿¡æ¯
â”œâ”€â”€ embedding_stats.json        # å‘é‡åŒ–å¤„ç†ç»Ÿè®¡
â”œâ”€â”€ documents_embeddings.npy    # æ–‡æ¡£çº§åˆ«å‘é‡åµŒå…¥
â”œâ”€â”€ documents_metadata.json     # æ–‡æ¡£å‘é‡å…ƒæ•°æ®
â”œâ”€â”€ sections_embeddings.npy     # ç« èŠ‚çº§åˆ«å‘é‡åµŒå…¥
â”œâ”€â”€ sections_metadata.json      # ç« èŠ‚å‘é‡å…ƒæ•°æ®
â”œâ”€â”€ tables_embeddings.npy       # è¡¨æ ¼å‘é‡åµŒå…¥
â””â”€â”€ tables_metadata.json        # è¡¨æ ¼å‘é‡å…ƒæ•°æ®
```

**å‘é‡åµŒå…¥ç‰¹æ€§**ï¼š
- ä½¿ç”¨å¤šè¯­è¨€é¢„è®­ç»ƒæ¨¡å‹ç”Ÿæˆé«˜è´¨é‡embedding
- æ”¯æŒæ–‡æ¡£ã€ç« èŠ‚ã€è¡¨æ ¼ä¸‰ä¸ªç²’åº¦çš„å‘é‡åŒ–
- åŒ…å«å®Œæ•´çš„å…ƒæ•°æ®æ˜ å°„å…³ç³»
- æ”¯æŒTF-IDFå’ŒSentence-BERTä¸¤ç§æ¨¡å‹

### ğŸ¯ vectorization/ - å‘é‡åŒ–ä¸­é—´æ–‡ä»¶
```
vectorization/
â”œâ”€â”€ documents_chunks.json       # æ–‡æ¡£åˆ†å—æ•°æ®
â”œâ”€â”€ sections_chunks.json        # ç« èŠ‚åˆ†å—æ•°æ®
â”œâ”€â”€ tables_chunks.json          # è¡¨æ ¼åˆ†å—æ•°æ®
â””â”€â”€ vectorization_ready.json    # å‘é‡åŒ–å°±ç»ªæ•°æ®
```

### ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **å¿«é€ŸæŸ¥çœ‹ç»“æœ**ï¼š
   - æŸ¥çœ‹ `analysis_report.md` äº†è§£æ•´ä½“æ•°æ®æ¦‚å†µ
   - æ£€æŸ¥ `pipeline_stats.json` ç¡®è®¤å¤„ç†çŠ¶æ€

2. **å¼€å‘é›†æˆ**ï¼š
   - ä½¿ç”¨ `json/` ä¸­çš„ç»“æ„åŒ–æ•°æ®è¿›è¡Œåº”ç”¨å¼€å‘
   - åˆ©ç”¨ `enhanced_embeddings/` ä¸­çš„å‘é‡æ–‡ä»¶å®ç°è¯­ä¹‰æœç´¢

3. **æ•°æ®åˆ†æ**ï¼š
   - åˆ†æ `analysis/` ä¸­çš„CSVæ–‡ä»¶è¿›è¡Œæ•°æ®æ¢ç´¢
   - ä½¿ç”¨åˆ†å—æ•°æ®ä¼˜åŒ–æ£€ç´¢ç­–ç•¥

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥å¸®åŠ©æ”¹è¿›é¡¹ç›®ã€‚

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚
